add file /opt/program/work/liliwang/dianxiao/line_on/train_features.py;
use test;
drop table `test.dianxiao_10_qk_new_feature`;
create table `test.dianxiao_10_qk_new_feature`
as
select
  transform(g.*)
  using 'python train_features.py'
  as(
  label,weight,customerid,call_times,connect_times,has_callin,has_staff_hangup,avg_waittime,min_waittime,max_waittime,avg_onlinetime,min_onlinetime,max_onlinetime,callresult,mobile_type,phone,gap,is_old,one_month_innum,two_month_innum,three_month_innum,datasource,day,str_zhengxin,str_jujie,str_zhuce,str_mingtian,str_mendian,str_kaolv,str_feilv,str_daka,str_guanji,str_bu,str_jie,online_ascending_num,online_decsending_num,waittime_ascending_num,waittime_decsending_num,avg_comments_cnt,location_new,beta_online,beta_wait
  )
  from 
  (select * from test.dianxiao_10_qk_copy) g;


create table dianxiao_1_qk_copy 
as 
select  label,	customerid,	callhisid,	call_times, connect_times, has_callin,	has_staff_hangup, avg_waittime, min_waittime,	max_waittime, avg_onlinetime, min_onlinetime,	max_onlinetime, all_call_waittime, all_call_onlinetime,   regexp_replace(comments, '\t', '\;') as comments, datasource,	location, callresult,	calltime, mobile_type,	phone,	gap,	is_old, one_month_innum, two_month_innum, three_month_innum 
from  
dianxiao_1_qk;


label   weight  customerid  call_times  connect_times,has_callin,has_staff_hangup,avg_waittime,min_waittime,max_waittime,avg_onlinetime,min_onlinetime,max_onlinetime,callresult,mobile_type,phone,gap,is_old,one_month_innum,two_month_innum,three_month_innum,datasource,day,str_zhengxin,str_jujie,str_zhuce,str_mingtian,str_mendian,str_kaolv,str_feilv,str_daka,str_guanji,str_bu,str_jie,online_ascending_num,online_decsending_num,waittime_ascending_num,waittime_decsending_num,avg_comments_cnt,location_new,beta_online,beta_wait
  
label,customerid,callhisid,call_times,connect_times,has_callin,has_staff_hangup,avg_waittime,min_waittime,max_waittime,avg_onlinetime,min_onlinetime,max_onlinetime,all_call_waittime,all_call_onlinetime,comments,datasource,location,callresult,calltime,mobile_type,phone,gap,is_old,one_month_innum,two_month_innum,three_month_innum   




